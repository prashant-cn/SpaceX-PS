<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script>

        let filters = new Object()
        
        function getEventTarget(e) {
            e = e || window.event;
            e.target.setAttribute('class', 'selected')
            return e.target || e.srcElement; 
        }
        
        const clearButton = document.querySelector('#clearSelection')
        clearButton.addEventListener('click', (event)=>{
            if(location.search){
                $('.filter').find("*").removeClass("selected");
                //update url
                window.history.pushState(null, null, `/`);
                getData('/')
            }
        })  
        
        Array.from(document.getElementsByClassName('filter_list'))
        .forEach((element)=>{
            element.addEventListener('click', (event)=>{

                $(element).find("*").removeClass("selected");
                var filterKey = element.id
                var filterValue = getEventTarget(event).innerHTML.toLowerCase();

                filters[element.id] = filterValue
                var urlParams = $.param( filters );
                //update url
                window.history.pushState(null, null, `/filters?${urlParams}`);
                //const queryString = location.pathname+location.search
                getData(location.search) 
            })
        })

        function getData(queryString){
            $.ajax({url: `/filtered${queryString}`, success: function(result){
                $(".filteredResults").html(result);
            }}); 
        }
        
    </script>